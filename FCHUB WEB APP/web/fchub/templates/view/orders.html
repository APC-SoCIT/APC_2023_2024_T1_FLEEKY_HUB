{% extends 'navbar/dashboard-navbar.html' %}
{% block title %}Admin Panel - View Orders{% endblock %}

{% block content %}
<div class="container">
    <h2 class="mb-4">View Orders</h2>

    <!-- Filter options -->
    <form method="get">
        <div class="mb-3">
            <label for="order_date">Order Date:</label>
            <input type="date" name="order_date" id="order_date" value="{{ request.GET.order_date }}">
        </div>
        <div class="mb-3">
            <label for="order_status">Order Status:</label>
            <select name="order_status" id="order_status">
                <option value="">All</option>
                <option value="Pending" {% if request.GET.order_status == "Pending" %}selected{% endif %}>Pending</option>
                <option value="Shipped" {% if request.GET.order_status == "Shipped" %}selected{% endif %}>Shipped</option>
                <option value="Delivered" {% if request.GET.order_status == "Delivered" %}selected{% endif %}>Delivered</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="total_price">Total Price:</label>
            <select name="total_price" id="total_price">
                <option value="">All</option>
                <option value="low_to_high" {% if request.GET.total_price == "low_to_high" %}selected{% endif %}>Low to High</option>
                <option value="high_to_low" {% if request.GET.total_price == "high_to_low" %}selected{% endif %}>High to Low</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="payment_type">Payment Type:</label>
            <select name="payment_type" id="payment_type">
                <option value="">All</option>
                <option value="online_payment" {% if request.GET.payment_type == "online_payment" %}selected{% endif %}>Online Payment</option>
                <option value="cash_on_delivery" {% if request.GET.payment_type == "cash_on_delivery" %}selected{% endif %}>Cash on Delivery</option>
            </select>
        </div>
        <button type="submit" class="btn btn-primary">Apply Filters</button>
        <a href="{% url 'fchub:orders' %}" class="btn btn-secondary">Reset Filters</a>
    </form>

    <table class="table table-hover table-bordered" id="order-table">
        <thead>
            <tr>
                <th>Order ID</th>
                <th>Ordered Products</th>
                <th>Type of Payment</th>
                <th>Ordered By</th>
                <th>Order Date</th>
                <th>Order Status</th>
                <th>Total Price</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for ordered_products, ordered_by, order in data %}
                <tr>
                    <td>{{ order.order_number }}</td>
                    <td>
                        <ul>
                            {% for ordered_product in ordered_products %}
                                <li>{{ ordered_product.product.name }} x{{ ordered_product.quantity }}</li>
                            {% endfor %}
                        </ul>
                    </td>
                    <td>{{ order.payment_method }}</td>
                    <td>{{ ordered_by.0.first_name }} {{ ordered_by.0.last_name }}</td>
                    <td>{{ order.order_date }}</td>
                    <td>{{ order.status }}</td>
                    <td>â‚±{{ order.total_price }}</td>
                    <td>
                        <div class="btn-group" role="group">
                            <a href="#" class="btn btn-primary btn-sm">
                                <i class="fas fa-edit fa-lg"></i> <!-- Larger Icon for Change Status -->
                            </a>
                            <a href="#" class="btn btn-success btn-sm">
                                <i class="fas fa-download fa-lg"></i> <!-- Larger Icon for Download Order -->
                            </a>
                            <a href="#" class="btn btn-info btn-sm">
                                <i class="fas fa-info-circle fa-lg"></i> <!-- Larger Icon for View Details -->
                            </a>
                        </div>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
